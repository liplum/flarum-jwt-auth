(()=>{var t={n:o=>{var e=o&&o.__esModule?()=>o.default:()=>o;return t.d(e,{a:e}),e},d:(o,e)=>{for(var n in e)t.o(e,n)&&!t.o(o,n)&&Object.defineProperty(o,n,{enumerable:!0,get:e[n]})},o:(t,o)=>Object.prototype.hasOwnProperty.call(t,o)};(()=>{"use strict";const o=flarum.core.compat["forum/app"];var e=t.n(o);const n=flarum.core.compat["common/extend"],r=flarum.core.compat["common/components/Button"];var a=t.n(r);const i=flarum.core.compat["common/components/LinkButton"];var u=t.n(i);const s=flarum.core.compat["forum/components/SessionDropdown"];var c=t.n(s);const l=flarum.core.compat["forum/ForumApplication"];var m=t.n(l);e().initializers.add("liplum-jwt-auth",(function(){(0,n.extend)(c().prototype,"items",(function(t){var o=e().forum.attribute("logoutRedirect");(o||!1===o)&&t.remove("logOut"),o&&t.add("logOutLink",u().component({icon:"fas fa-sign-out-alt",href:o},e().translator.trans("core.forum.header.log_out_button")))})),(0,n.extend)(m().prototype,"mount",(function(){var t=e().forum.attribute("jwtIframe");if(t){var o=new Date,n=!1,r=!1,i=new URL(t);window.addEventListener("message",(function(t){if(t.origin===i.origin&&"object"==typeof t.data&&t.data.hasOwnProperty("jwtSessionState"))switch(t.data.jwtSessionState){case"login":if(e().session.user||n)return;if((new Date).getTime()-o.getTime()<e().forum.attribute("autoLoginDelay"))return void window.location.reload();n=!0,u("success","login");break;case"logout":if(!e().session.user||r)return;r=!0,u("error","logout")}function u(t,o){e().alerts.show({type:t,controls:[a().component({className:"Button Button--link",onclick:function(){window.location.reload()}},e().translator.trans("liplum-jwt-auth.forum.alert.refresh"))]},e().translator.trans("liplum-jwt-auth.forum.alert."+o))}}),!1);var u=document.createElement("iframe");u.src=t,u.width="0",u.height="0",u.style.position="absolute",u.style.top="-1000px;",u.style.left="-1000px",document.body.appendChild(u)}}))}))})(),module.exports={}})();
//# sourceMappingURL=forum.js.map